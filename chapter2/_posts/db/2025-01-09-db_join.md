# 데이터 베이스 조인 알고리즘

데이터 베이스에서 특정 조인 알고리즘을 선택하는 것은 불가능하다. `query optimizer`가 쿼리를 실행할 때 조인의 종류 중 자동으로 가장 성능이 좋은 알고리즘으로 결정하게 된다

- 힌트를 설정 시 해당 알고리즘으로 조인이 가능하다

### 중첩 루프 조인 (Nested Loop Join)

- 한 테이블의 각 행에 대해 다른 테이블의 모든 행을 순차적으로 검사하다 조인하는 방법이다
    - O(M*N)
- Join 컬럼에 대한 인덱스를 생성해주면 성능에 유리하다

### 정렬 병합 조인 (Sort Merge Join)

- 정렬 병합 조인은 두 테이블을 **조인할 필드를 기준**으로 각각 정렬한 후, 정렬된 순서에 따라 행을 병합하여 조인하는 방법이다
    - O(M logM + N logN), 하나의 테이블 정렬 복잡도 = N log N
- 데이터가 이미 정렬되어 있거나 등가조인이 아닌 `대소비교연산자`(<, >, ≤, ≥)로 조인할 때 효율적이다
    - 특정 조건 (ex: >)으로 자주 조인하는 경우, 해당 조인 조건에 맞게 데이터를 미리 정렬하거나 인덱스를 구성함으로써 조인 성능을 향상시킬 수 있다

### 해시 조인 (Hash Join)

- **한 테이블(**보통 작은 테이블)의 행을 사용해서 `해시 테이블`을 만든 다음, 다른 테이블을 순회하면서 해시 테이블을 사용하여 조인한다
- 하나의 테이블이 서버 메모리에 온전히 들어간다면 `NL조인` 보다 효율적이다. 다만 메모리가 부족할 경우 성능이 저하될 수 있고 동등(=) 조건에서만 사용할 수 있다

**작동방식**

- 빌드 단계: 바이트가 더 작은 테이블로부터 `해시 테이블`을 생성한다. 각 행의 조인 키에 `해시 함수`를 적용하여 해시 테이블에 저장한다
- **프로브 단계**: 다른 테이블의 각 행에 대한 **조인키를 해싱**하여 앞서 만든 **해시값과 비교**해서 해시 테이블에서 매칭되는 행을 찾으면 해당 행들을 조인 결과 테이블에 추가한다

**시간복잡도**

- O(M+N), 여기서 M은 빌드 단계 테이블 행 수 이고, N은 프로브 단계 테이블의 행 수 이다
- 성능: 큰 데이터셋에 대해 매우 효율적이며, 특히 두 테이블 사이에 큰 크기 차이가 있을 때 효율적이다